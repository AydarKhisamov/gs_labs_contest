ЗАДАЧА:

*   Создание рекомендательной системы для онлайн-кинотеатра Триколор Кино и ТВ. Участникам потребуется предсказать ТОП-20 наиболее релевантных фильмов каждому из
пользователей, просмотренных им в следующие 30 дней.


ДАННЫЕ:

*   movies.csv:
    *   id - id фильма;
    *   name - название фильма;
    *   year - год выпуска фильма;
    *   date_publication - дата публикации фильма в системе;
    *   genres - список id жанров фильма;
    *   countries - список id стран производства фильма;
    *   description - описание фильма;
    *   staff - список id персонала фильма;

*   genres.csv:
    *   id - id жанра фильма;
    *   name - жанр фильма;

*   countries.csv:
    *   id - id страны;
    *   name - название страны;

*   staff.csv:
    *   id - id персоны;
    *   name - имя персоны;
    *   role - должность (актёр, режиссёр и т.д.);

*   logs.csv:
    *   id - id лога;
    *   user_id - id пользователя;
    *   datetime - timestamp окончания просмотра фильма;
    *   duration - длительность просмотра фильма;
    *   movie_id - id фильма;


ПРЕДОБРАБОТКА ДАННЫХ:

*   Признак "приблизительная длительность фильма" вычислялся особым образом (функция get_approx_duration), исходя из распределения длительности пользовательских просмотров на основании данных логов. Сделал выбор в пользу этого "дешёвого" подхода вместо "дорогого" парсинга.
*   Сессия просмотра фильма пользователем ограничивается одними сутками. Если между завершением и началом просмотра одного и того же фильма одним и тем же пользователем прошло более суток, то эти просмотры относятся к разным сессиям. Для каждой пары пользователь-фильм фиксировалась сессия с самой большой длительностью просмотра.
*   Каждая пара пользователь-фильм получала бинарную отметку:
    *   0 (отрицательное взаимодействие), если длительность сессии составляет менее 10% от длительности фильма;
    *   1 (положительное взаимодействие), если длительность сессии составляет более 10% от длительности фильма;

    Отметка 0 подразумевает, что запуск фильма был случайный / поисковый / автоматический; 1 - фильм был досмотрен, а следовательно, понравился, либо фильм оказался достаточно привлекательным, чтобы на него "засмотреться".


ПОДХОД К РЕШЕНИЮ:
*   2-уровневая модель:
    *   Модель 1-го уровня: LightFM
    *   Модель 2-го уровня: CatBoostClassifier

    Идея состояла в том, чтобы:
    *   на первом этапе с помощью модели коллаборативной фильтрации получить некоторое заданное кол-во кандидатов
    *   на втором этапе каждого кандидата-наблюдение дополнить признаками и обучить модель, которая будет определять вероятность отнесения каждого кандидата к классу 1, а далее отобрать кандидатов с наибольшей вероятностью.


РЕЗУЛЬТАТ:
*   7-е место в соревновании;
*   Метрика MAP@20: 0.00396
